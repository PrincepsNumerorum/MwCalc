<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>数学基礎講座：三角比と単位円の完全攻略（改訂版）</title>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    window.MathJax = {
        tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
        svg: { fontCache: 'global' }
    };
</script>

<style>
    :root {
        --bg-color: #121212;
        --text-color: #ffffff;
        --accent-cos: #00d2ff; /* Cyber Blue - Cosine/Base */
        --accent-sin: #ff007a; /* Neon Pink - Sine/Height */
        --accent-tan: #00ff9d; /* Neon Green - Tan/Slope */
        --accent-history: #ffd700; /* Gold - History */
        --panel-bg: #1e1e1e;
        --slide-padding: 30px;
    }

    body {
        margin: 0;
        background-color: var(--bg-color);
        color: var(--text-color);
        font-family: "Helvetica Neue", Arial, "Hiragino Kaku Gothic ProN", sans-serif;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
    }

    /* Presentation Container */
    #deck {
        position: relative;
        width: 100%;
        height: 100%;
        perspective: 1000px;
    }

    .slide {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        box-sizing: border-box;
        padding: var(--slide-padding);
        
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        
        opacity: 0;
        pointer-events: none;
        transform: translate3d(50px, 0, 0);
        transition: opacity 0.4s ease, transform 0.4s ease;
        z-index: 0;
        overflow-y: auto; 
    }

    .slide::-webkit-scrollbar { width: 8px; }
    .slide::-webkit-scrollbar-track { background: transparent; }
    .slide::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }

    .slide.active {
        opacity: 1;
        pointer-events: auto;
        transform: translate3d(0, 0, 0);
        z-index: 10;
    }

    .slide.past {
        opacity: 0;
        transform: translate3d(-50px, 0, 0);
    }

    /* Typography */
    h1 { font-size: 3.2rem; margin: 0 0 20px 0; color: var(--accent-cos); text-align: center; line-height: 1.2; text-shadow: 0 0 20px rgba(0, 210, 255, 0.4); }
    h2 { font-size: 2.2rem; margin-bottom: 20px; border-bottom: 3px solid var(--accent-cos); color: #fff; display: inline-block; padding-bottom: 5px; text-align: center;}
    h3 { font-size: 1.6rem; color: var(--accent-tan); margin: 15px 0; }
    p, li { font-size: 1.5rem; line-height: 1.6; margin-bottom: 0.8rem; max-width: 95%; }
    
    ul { list-style: none; padding: 0; margin: 0; }
    li { position: relative; padding-left: 1.2em; margin-bottom: 0.5em; }
    li::before { content: "➤"; position: absolute; left: 0; color: var(--accent-cos); font-size: 0.8em; top: 0.2em; }

    .highlight { color: var(--accent-history); font-weight: bold; }
    .important { color: var(--accent-sin); font-weight: bold; border-bottom: 2px solid var(--accent-sin); }
    
    .text-cos { color: var(--accent-cos); font-weight: bold; }
    .text-sin { color: var(--accent-sin); font-weight: bold; }
    .text-tan { color: var(--accent-tan); font-weight: bold; }
    
    /* Box Styles */
    .box {
        background: var(--panel-bg);
        border: 1px solid #444;
        border-radius: 15px;
        padding: 20px 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        margin: 15px 0;
        text-align: center;
        width: fit-content;
        min-width: 300px;
        max-width: 90%;
    }

    /* Fragment Animation */
    .fragment {
        opacity: 0;
        transform: translateY(10px);
        transition: all 0.3s ease-out;
    }
    .fragment.visible {
        opacity: 1;
        transform: translateY(0);
    }

    /* Interactive Elements & SVG */
    .interactive-area {
        background: #000;
        border: 2px solid #333;
        border-radius: 20px;
        padding: 20px;
        margin-top: 10px;
        text-align: center;
        box-shadow: inset 0 0 50px rgba(0,0,0,0.8);
        width: 100%;
        max-width: 800px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    
    svg { 
        overflow: visible; 
        width: 100%; 
        height: auto;
        max-height: 50vh;
        display: block;
        margin: 0 auto;
    }
    
    svg text {
        fill: #ffffff;
        font-family: sans-serif;
    }

    input[type=range] { width: 80%; max-width: 400px; transform: scale(1.2); margin: 20px 0; cursor: pointer; accent-color: var(--accent-cos); }

    /* Controls */
    #controls {
        position: fixed;
        bottom: 20px;
        right: 20px;
        display: flex;
        gap: 10px;
        z-index: 100;
    }
    .btn {
        background: rgba(255,255,255,0.1);
        border: none;
        color: white;
        padding: 10px 20px;
        cursor: pointer;
        border-radius: 5px;
        font-size: 1rem;
        transition: background 0.2s;
        backdrop-filter: blur(5px);
    }
    .btn.active { background: var(--accent-cos); color: #000; }
    .btn:hover { background: var(--accent-cos); color: #000; }

    #progress-bar {
        position: fixed;
        bottom: 0;
        left: 0;
        height: 5px;
        background: var(--accent-cos);
        width: 0%;
        transition: width 0.3s;
        z-index: 100;
    }

    .row { display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; width: 100%; }
    .col { flex: 1; min-width: 250px; }
    
    .val-label { font-size: 24px; font-weight: bold; fill: var(--accent-tan); }

    /* Table Styles */
    table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 1.4rem; }
    th, td { border: 1px solid #444; padding: 10px; text-align: center; }
    th { background: #333; color: white; }
    td { background: rgba(255,255,255,0.05); }

    /* Quiz Styles */
    .quiz-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; width: 100%; max-width: 900px; }
    .quiz-item { background: #222; padding: 15px; border-radius: 10px; border: 1px solid #444; cursor: pointer; transition: 0.3s; }
    .quiz-item:hover { background: #333; border-color: var(--accent-cos); }
    .quiz-q { font-weight: bold; margin-bottom: 10px; }
    .quiz-a { display: none; color: var(--accent-history); margin-top: 10px; border-top: 1px solid #555; padding-top: 5px;}
    .quiz-item.revealed .quiz-a { display: block; }
    .quiz-item.revealed { border-color: var(--accent-tan); }

    /* Quadrant Sign Colors */
    .sign-bg-plus { fill: rgba(255, 100, 100, 0.2); }
    .sign-bg-minus { fill: rgba(100, 100, 255, 0.2); }
    .sign-text { font-size: 40px; font-weight: bold; text-anchor: middle; dominant-baseline: middle; fill: white; }

</style>
</head>
<body>

<div id="deck">

    <div class="slide active">
        <h1>数学基礎講座<br>2時間目</h1>
        <p style="font-size: 1.5rem; letter-spacing: 0.2em; color: #888;">TRIGONOMETRY & UNIT CIRCLE</p>
        <div class="box" style="margin-top: 40px;">
            <p style="margin:0.5em 0;">テーマ：<span class="important">「単位円」と「三角比」の完全攻略</span></p>
        </div>
        <p style="font-size: 1rem; margin-top: 40px; opacity: 0.6;">キーボードの [→] または画面右下のボタンで進んでください</p>
    </div>

    <div class="slide">
        <h2>本日のメニュー</h2>
        <ul style="font-size: 1.2rem;">
            <li>導入：タレスのピラミッド測定と「比」の威力</li>
            <li>基本：直角三角形と sin, cos, tan の定義</li>
            <li>道具：最強の武器「単位円」の導入</li>
            <li>実験：0°〜90°で値はどう動くか</li>
            <li>重要：絶対に覚えるべき「有名角」</li>
            <li>拡張：360°の世界と符号（＋−）</li>
            <li>実践：基本問題と6本ノック</li>
            <li>応用：ゲームプログラミングとリサージュ図形</li>
            <li>歴史：偉人ビールーニーと地球の大きさ</li>
        </ul>
    </div>

    <div class="slide">
        <h2>導入：測れないものを測る</h2>
        <p>あなたは今、校庭に立っています。<br>遠くに見える高い木の長さを知りたい。</p>
        <div class="box fragment">
            <p>木には登れない。切り倒すわけにもいかない。<br>どうしますか？</p>
        </div>
        <p class="fragment">ここで役立つのが<span class="important">「相似（そうじ）」</span>と<span class="important">「比」</span>です。</p>
    </div>

    <div class="slide">
        <h2>「相似」の魔法</h2>
        <p>大きさが違っても、形が同じなら（相似なら）、<br><span class="highlight">辺の比率は同じ</span>になります。</p>
        <div class="interactive-area" style="background:transparent; border:none; box-shadow:none;">
            <svg viewBox="0 0 600 200" style="max-width: 600px;">
                <path d="M 50 150 L 150 150 L 150 50 Z" stroke="white" stroke-width="2" fill="none"/>
                <text x="70" y="140" fill="white" font-size="16">小さい三角形</text>
                
                <path d="M 250 150 L 550 150 L 550 -150 Z" stroke="var(--accent-cos)" stroke-width="2" fill="none"/>
                <text x="350" y="140" fill="var(--accent-cos)" font-size="20">巨大な三角形</text>
                
                <text x="80" y="170" fill="white">角度が同じなら…</text>
                <text x="350" y="180" fill="var(--accent-cos)">比率は同じ！</text>
            </svg>
        </div>
    </div>

    <div class="slide">
        <h2>歴史：タレスのピラミッド測定</h2>
        <p>2500年前、タレスはエジプトのピラミッドの高さを、<br>「自分の杖」と「影」だけで測りました。</p>
        <div class="box fragment" style="text-align: left;">
            <p><strong>【計算の仕組み】</strong></p>
            <p>1. 1mの杖を立てたら、影が2mだった。（比率 $1:2$）</p>
            <p>2. その瞬間、ピラミッドの影を測ると280mだった。</p>
            <p>3. ならば高さは影の半分のはずだ！</p>
            <p style="text-align: center; font-size: 1.8rem;">$H = 280 \times \frac{1}{2} = 140\text{m}$</p>
        </div>
    </div>

    <div class="slide">
        <h2>【実験】タレスの視点</h2>
        <p>太陽の位置（角度）が変わると、影も伸びますが、<br><span class="highlight">「杖と影の比」と「ピラミッドと影の比」</span>は常に一致します。</p>
        <div class="interactive-area">
            <svg id="svg-thales" viewBox="0 0 600 300">
                <line x1="0" y1="250" x2="600" y2="250" stroke="#777" stroke-width="2"/>
                
                <line x1="100" y1="250" x2="100" y2="200" stroke="white" stroke-width="3"/> <text x="80" y="220" fill="white" font-size="14">杖(1)</text>
                
                <path d="M 350 250 L 450 100 L 550 250 Z" fill="#222" stroke="var(--accent-cos)" stroke-width="2"/>
                <line x1="450" y1="250" x2="450" y2="100" stroke="var(--accent-cos)" stroke-dasharray="4"/>
                <text x="460" y="130" fill="var(--accent-cos)" font-size="14">H(?)</text>
                
                <line id="shadow-stick" x1="100" y1="250" x2="150" y2="250" stroke="#aaa" stroke-width="4"/>
                <line id="shadow-pyramid" x1="450" y1="250" x2="600" y2="250" stroke="#aaa" stroke-width="4"/>
                
                <line id="ray-stick" x1="50" y1="150" x2="150" y2="250" stroke="yellow" stroke-width="1" stroke-dasharray="4" opacity="0.8"/>
                <line id="ray-pyramid" x1="300" y1="-50" x2="600" y2="250" stroke="yellow" stroke-width="1" stroke-dasharray="4" opacity="0.8"/>
                
                <text x="300" y="290" text-anchor="middle" fill="white" id="thales-text" font-size="18">...</text>
            </svg>
            <input type="range" id="thales-slider" min="20" max="60" value="45" oninput="updateThales()">
        </div>
    </div>

    <div class="slide">
        <h2>角度が決まれば、比は決まる</h2>
        <p>タレスのように「相似」を使えば測量ができます。<br>これを体系化したものが<strong>三角比</strong>です。</p>
        <div class="box fragment">
            <p>「この角度なら、辺の比率はこれ！」<br>というデータをまとめたカタログのようなものです。</p>
        </div>
    </div>

    <div class="slide">
        <h2>直角三角形での呼び名</h2>
        <p>まずは名前と場所を一致させましょう。</p>
        <div class="interactive-area" style="background:transparent; border:none; box-shadow:none;">
            <svg viewBox="0 0 500 300">
                <path d="M 50 250 L 400 250 L 400 50 Z" stroke="white" stroke-width="4" fill="none"/>
                <path d="M 370 250 L 370 220 L 400 220" stroke="white" stroke-width="2" fill="none"/>
                <path d="M 100 250 A 50 50 0 0 0 90 215" stroke="#aaa" stroke-width="2" fill="none"/>
                <text x="110" y="235" fill="white" font-size="28">θ</text>
                
                <text x="140" y="110" fill="white" font-size="32" font-weight="bold">斜辺 (r)</text>
                
                <text x="430" y="150" class="text-sin" font-size="32">対辺 (高さ y)</text>
                <line x1="420" y1="150" x2="400" y2="150" stroke="var(--accent-sin)" stroke-width="2"/>
                
                <text x="200" y="300" class="text-cos" font-size="32">隣辺 (底辺 x)</text>
                <line x1="225" y1="280" x2="225" y2="250" stroke="var(--accent-cos)" stroke-width="2"/>
            </svg>
        </div>
        <ul>
            <li><strong>斜辺</strong>：直角の向かい側（一番長い）</li>
            <li><strong class="text-sin">対辺</strong>：角θの向かい側（高さ）</li>
            <li><strong class="text-cos">隣辺</strong>：角θの隣（底辺）</li>
        </ul>
    </div>

    <div class="slide">
        <h2>1. 正弦：サイン（sin）</h2>
        <div class="row">
            <div class="col" style="flex:1;">
                <svg viewBox="0 0 300 200">
                    <path d="M 30 170 L 250 170 L 250 30 Z" stroke="#555" stroke-width="2" fill="none"/>
                    <line x1="30" y1="170" x2="250" y2="30" stroke="white" stroke-width="3"/> <line x1="250" y1="170" x2="250" y2="30" stroke="var(--accent-sin)" stroke-width="5"/> <rect x="230" y="150" width="20" height="20" stroke="white" fill="none"/>
                    
                    <text x="100" y="90" fill="white" font-size="24">r</text>
                    <text x="260" y="100" class="text-sin" font-size="24">y</text>
                </svg>
            </div>
            <div class="col box" style="flex:1.5; text-align:left;">
                <h3 class="text-sin">斜めに対する「高さ」の割合</h3>
                <p style="font-size: 2.5rem;">$\sin \theta = \frac{\text{対辺}}{\text{斜辺}} = \frac{\color{#ff007a}{y}}{r}$</p>
                <p>日本語で<strong>「正弦（せいげん）」</strong>といいます。</p>
            </div>
        </div>
    </div>

    <div class="slide">
        <h2>2. 余弦：コサイン（cos）</h2>
        <div class="row">
            <div class="col" style="flex:1;">
                <svg viewBox="0 0 300 200">
                    <path d="M 30 170 L 250 170 L 250 30 Z" stroke="#555" stroke-width="2" fill="none"/>
                    <line x1="30" y1="170" x2="250" y2="30" stroke="white" stroke-width="3"/> <line x1="30" y1="170" x2="250" y2="170" stroke="var(--accent-cos)" stroke-width="5"/> <rect x="230" y="150" width="20" height="20" stroke="white" fill="none"/>
                    
                    <text x="100" y="90" fill="white" font-size="24">r</text>
                    <text x="140" y="195" class="text-cos" font-size="24">x</text>
                </svg>
            </div>
            <div class="col box" style="flex:1.5; text-align:left;">
                <h3 class="text-cos">斜めに対する「底辺」の割合</h3>
                <p style="font-size: 2.5rem;">$\cos \theta = \frac{\text{隣辺}}{\text{斜辺}} = \frac{\color{#00d2ff}{x}}{r}$</p>
                <p>日本語で<strong>「余弦（よげん）」</strong>といいます。</p>
            </div>
        </div>
    </div>

    <div class="slide">
        <h2>3. 正接：タンジェント（tan）</h2>
        <div class="row">
            <div class="col" style="flex:1;">
                <svg viewBox="0 0 300 200">
                    <path d="M 30 170 L 250 170 L 250 30 Z" stroke="#555" stroke-width="2" fill="none"/>
                    <line x1="30" y1="170" x2="250" y2="170" stroke="var(--accent-cos)" stroke-width="3"/> <line x1="250" y1="170" x2="250" y2="30" stroke="var(--accent-sin)" stroke-width="3"/> <line x1="30" y1="170" x2="250" y2="30" stroke="var(--accent-tan)" stroke-width="5" stroke-dasharray="5"/> <rect x="230" y="150" width="20" height="20" stroke="white" fill="none"/>
                    
                    <text x="140" y="195" class="text-cos" font-size="24">x</text>
                    <text x="260" y="100" class="text-sin" font-size="24">y</text>
                </svg>
            </div>
            <div class="col box" style="flex:1.5; text-align:left;">
                <h3 class="text-tan">底辺に対する「高さ」の割合（傾き）</h3>
                <p style="font-size: 2.5rem;">$\tan \theta = \frac{\text{対辺}}{\text{隣辺}} = \frac{\color{#ff007a}{y}}{\color{#00d2ff}{x}}$</p>
                <p>日本語で<strong>「正接（せいせつ）」</strong>といいます。</p>
            </div>
        </div>
    </div>

    <div class="slide">
        <h2>最強の道具：「単位円」</h2>
        <p>三角形だけで考えると、大きさの計算が面倒です。<br>数学者たちは天才的なズルを思いつきました。</p>
        <div class="box fragment">
            <h3 class="important">「斜辺（r）を 1 に固定しよう」</h3>
        </div>
        <p class="fragment">半径1の円。これを<span class="highlight">「単位円」</span>と呼びます。</p>
    </div>

    <div class="slide">
        <h2>なぜ半径1にするのか？</h2>
        <p>分母が1になると、世界が変わります。</p>
        <div class="row">
            <div class="box fragment col">
                <p>$\sin \theta = \frac{y}{r} = \frac{y}{1} = y$</p>
                <p class="text-sin">高さ = sin</p>
            </div>
            <div class="box fragment col">
                <p>$\cos \theta = \frac{x}{r} = \frac{x}{1} = x$</p>
                <p class="text-cos">底辺 = cos</p>
            </div>
        </div>
        <p class="fragment important">「比率」がそのまま「座標（長さ）」になる！</p>
    </div>

    <div class="slide">
        <h2>単位円上の座標</h2>
        <div class="interactive-area" style="background:transparent; border:none; box-shadow:none;">
            <svg viewBox="-20 -20 220 220" style="max-height: 300px;">
                <path d="M 0 200 L 200 200 A 200 200 0 0 0 0 0 Z" fill="#222" stroke="#555"/>
                <line x1="0" y1="200" x2="200" y2="200" stroke="white"/> <line x1="0" y1="200" x2="0" y2="0" stroke="white"/> <line x1="0" y1="200" x2="141" y2="59" stroke="white" stroke-width="2"/>
                <circle cx="141" cy="59" r="5" fill="white"/>
                <text x="150" y="50" fill="white" font-size="20">P (cosθ, sinθ)</text>
                
                <line x1="141" y1="200" x2="141" y2="59" stroke="var(--accent-sin)" stroke-width="3"/>
                <line x1="0" y1="200" x2="141" y2="200" stroke="var(--accent-cos)" stroke-width="3"/>
            </svg>
        </div>
        <ul>
            <li class="fragment"><span class="text-cos">横座標 (x)</span> ＝ $\cos \theta$</li>
            <li class="fragment"><span class="text-sin">縦座標 (y)</span> ＝ $\sin \theta$</li>
            <li class="fragment"><span class="text-tan">傾き</span> ＝ $\tan \theta = y/x$</li>
        </ul>
    </div>

    <div class="slide">
        <h2>【実験】0°〜90°の変化</h2>
        <p>角度を変えて、縦(sin)・横(cos)の長さ、傾き(tan)を観察してみましょう。</p>
        <div class="interactive-area">
            <svg id="svg-unit-90" viewBox="-20 -20 250 250" height="300">
                <path d="M 0 200 L 200 200 A 200 200 0 0 0 0 0 Z" fill="#222" stroke="#555"/>
                <line x1="0" y1="200" x2="220" y2="200" stroke="#fff" stroke-width="1"/>
                <line x1="0" y1="200" x2="0" y2="-20" stroke="#fff" stroke-width="1"/>
                
                <line id="u90-hyp" x1="0" y1="200" x2="141" y2="59" stroke="white" stroke-width="3"/>
                <line id="u90-cos" x1="0" y1="200" x2="141" y2="200" stroke="var(--accent-cos)" stroke-width="5"/>
                <line id="u90-sin" x1="141" y1="200" x2="141" y2="59" stroke="var(--accent-sin)" stroke-width="5"/>
                
                <line x1="200" y1="200" x2="200" y2="0" stroke="#555" stroke-dasharray="2"/>
                <line id="u90-tan-line" x1="0" y1="200" x2="200" y2="0" stroke="var(--accent-tan)" stroke-width="2" opacity="0.5"/>
                
                <circle id="u90-p" cx="141" cy="59" r="8" fill="white"/>
            </svg>
            <input type="range" id="input-u90" min="0" max="89" value="45" oninput="updateUnit90()">
            <div style="font-size: 1.4rem; margin-top:10px;">
                $\theta =$ <span id="val-u90-deg" class="highlight">45</span>°<br>
                <span class="text-sin">sin: <span id="val-u90-sin">0.71</span></span> / 
                <span class="text-cos">cos: <span id="val-u90-cos">0.71</span></span> / 
                <span class="text-tan">tan: <span id="val-u90-tan">1.00</span></span>
            </div>
        </div>
    </div>

    <div class="slide">
        <h2>「有名角」の攻略</h2>
        <p>きりのいい比率になる角度が5つあります。</p>
        <div class="box">
            <h3 class="important">これは絶対に暗記しておく必要があります。</h3>
        </div>
        <p>ただし、数字の羅列ではなく<span class="highlight">「形」</span>で頭に入れましょう。</p>
    </div>

    <div class="slide">
        <h2>45°：正方形の半分</h2>
        <div class="row">
            <div class="col">
                <svg viewBox="0 0 240 240" width="240" height="240">
                    <path d="M 20 220 L 220 220 L 220 20 Z" stroke="white" stroke-width="2" fill="none"/>
                    
                    <rect x="200" y="200" width="20" height="20" stroke="white" stroke-width="2" fill="none"/>
                    
                    <path d="M 60 220 A 40 40 0 0 0 50 190" stroke="white" fill="none"/>
                    <text x="70" y="210" fill="white" font-size="20">45°</text>
                    
                    <text x="80" y="110" fill="white" font-size="28" font-weight="bold">√2</text>
                    <text x="120" y="255" class="text-cos" font-size="28" font-weight="bold">1</text>
                    <text x="230" y="130" class="text-sin" font-size="28" font-weight="bold">1</text>
                </svg>
            </div>
            <div class="col box">
                <p>比率 $1 : 1 : \sqrt{2}$</p>
                <p>斜辺を1にすると…</p>
                <p>$\sin 45^\circ = 1/\sqrt{2}$</p>
                <p>$\cos 45^\circ = 1/\sqrt{2}$</p>
                <p>$\tan 45^\circ = 1$</p>
            </div>
        </div>
    </div>

    <div class="slide">
        <h2>30°：正三角形の半分（横長）</h2>
        <div class="row">
            <div class="col">
                <svg viewBox="0 0 240 160" width="240" height="160">
                    <path d="M 20 140 L 220 140 L 220 24 Z" stroke="white" stroke-width="2" fill="none"/>
                    
                    <rect x="200" y="120" width="20" height="20" stroke="white" stroke-width="2" fill="none"/>
                    
                    <path d="M 60 140 A 40 40 0 0 0 55 120" stroke="white" fill="none"/>
                    <text x="70" y="130" fill="white" font-size="20">30°</text>
                    
                    <text x="110" y="70" fill="white" font-size="28" font-weight="bold">2</text>
                    <text x="120" y="175" class="text-cos" font-size="28" font-weight="bold">√3</text>
                    <text x="230" y="90" class="text-sin" font-size="28" font-weight="bold">1</text>
                </svg>
            </div>
            <div class="col box">
                <p>比率 $1 : 2 : \sqrt{3}$</p>
                <p>高さが斜辺の半分！</p>
                <p>$\sin 30^\circ = 1/2$</p>
                <p>$\cos 30^\circ = \sqrt{3}/2$</p>
                <p>$\tan 30^\circ = 1/\sqrt{3}$</p>
            </div>
        </div>
    </div>

    <div class="slide">
        <h2>60°：正三角形の半分（縦長）</h2>
        <div class="row">
            <div class="col">
                <svg viewBox="0 0 160 260" width="160" height="260">
                    <path d="M 20 240 L 140 240 L 140 32 Z" stroke="white" stroke-width="2" fill="none"/>
                    
                    <rect x="120" y="220" width="20" height="20" stroke="white" stroke-width="2" fill="none"/>
                    
                    <path d="M 50 240 A 30 30 0 0 0 40 210" stroke="white" fill="none"/>
                    <text x="60" y="230" fill="white" font-size="20">60°</text>
                    
                    <text x="70" y="130" fill="white" font-size="28" font-weight="bold">2</text>
                    <text x="80" y="275" class="text-cos" font-size="28" font-weight="bold">1</text>
                    <text x="150" y="150" class="text-sin" font-size="28" font-weight="bold">√3</text>
                </svg>
            </div>
            <div class="col box">
                <p>比率 $\sqrt{3} : 2 : 1$</p>
                <p>底辺が斜辺の半分！</p>
                <p>$\sin 60^\circ = \sqrt{3}/2$</p>
                <p>$\cos 60^\circ = 1/2$</p>
                <p>$\tan 60^\circ = \sqrt{3}$</p>
            </div>
        </div>
    </div>

    <div class="slide">
        <h2>0°：ペチャンコ</h2>
        <div class="interactive-area" style="background:transparent; border:none; box-shadow:none;">
            <svg viewBox="0 0 300 120" style="height:120px;">
                <line x1="20" y1="80" x2="280" y2="80" stroke="#444" stroke-width="2"/>
                <line x1="20" y1="80" x2="280" y2="80" stroke="white" stroke-width="4" stroke-dasharray="4"/>
                <line x1="20" y1="80" x2="280" y2="80" stroke="var(--accent-cos)" stroke-width="4" opacity="0.5"/>
                
                <circle cx="280" cy="80" r="6" fill="white"/>
                <text x="150" y="110" class="text-cos" font-size="24">x (cos) = 1</text>
                <text x="290" y="80" class="text-sin" font-size="24">y (sin) = 0</text>
                <text x="20" y="70" fill="white" font-size="20">θ=0°</text>
            </svg>
        </div>
        <div class="box">
            <p>$\sin 0^\circ = 0$　(高さなし)</p>
            <p>$\cos 0^\circ = 1$　(横全開)</p>
            <p>$\tan 0^\circ = 0$　(傾きなし)</p>
        </div>
    </div>

    <div class="slide">
        <h2>90°：真っ直ぐ上</h2>
        <div class="interactive-area" style="background:transparent; border:none; box-shadow:none;">
            <svg viewBox="0 0 140 280" style="height:280px;">
                <line x1="70" y1="260" x2="70" y2="20" stroke="#444" stroke-width="2"/>
                <line x1="70" y1="260" x2="70" y2="20" stroke="white" stroke-width="4" stroke-dasharray="4"/>
                <line x1="70" y1="260" x2="70" y2="20" stroke="var(--accent-sin)" stroke-width="4" opacity="0.5"/>
                
                <circle cx="70" cy="20" r="6" fill="white"/>
                <text x="85" y="140" class="text-sin" font-size="24">y (sin) = 1</text>
                <text x="70" y="290" class="text-cos" font-size="24">x(cos)=0</text>
                <text x="10" y="260" fill="white" font-size="20">θ=90°</text>
            </svg>
        </div>
        <div class="box">
            <p>$\sin 90^\circ = 1$　(高さ全開)</p>
            <p>$\cos 90^\circ = 0$　(横なし)</p>
            <p>$\tan 90^\circ$ = <span class="important">定義なし</span> (崖)</p>
        </div>
    </div>

    <div class="slide">
        <h2>0°〜90° まとめ</h2>
        <table>
            <tr>
                <th>$\theta$</th>
                <th>$0^\circ$</th>
                <th>$30^\circ$</th>
                <th>$45^\circ$</th>
                <th>$60^\circ$</th>
                <th>$90^\circ$</th>
            </tr>
            <tr>
                <th class="text-sin">$\sin$</th>
                <td>$0$</td>
                <td>$1/2$</td>
                <td>$1/\sqrt{2}$</td>
                <td>$\sqrt{3}/2$</td>
                <td>$1$</td>
            </tr>
            <tr>
                <th class="text-cos">$\cos$</th>
                <td>$1$</td>
                <td>$\sqrt{3}/2$</td>
                <td>$1/\sqrt{2}$</td>
                <td>$1/2$</td>
                <td>$0$</td>
            </tr>
            <tr>
                <th class="text-tan">$\tan$</th>
                <td>$0$</td>
                <td>$1/\sqrt{3}$</td>
                <td>$1$</td>
                <td>$\sqrt{3}$</td>
                <td>なし</td>
            </tr>
        </table>
    </div>

    <div class="slide">
        <h2>世界を拡張する（0°〜360°）</h2>
        <p>三角形の内角は180°までですが、<br><span class="highlight">回転</span>と考えれば、どこまでも回せます。</p>
        <div class="box fragment">
            <p>単位円上なら、x軸やy軸のマイナス側に点が行けます。<br>ここで<span class="important">マイナスの値</span>が登場します。</p>
        </div>
    </div>

    <div class="slide">
        <h2>4つの世界（象限）</h2>
        <div class="interactive-area" style="background:transparent; border:none; box-shadow:none;">
            <svg viewBox="-150 -150 300 300" height="300">
                <rect x="0" y="-150" width="150" height="150" fill="rgba(255,255,255,0.05)"/> <rect x="-150" y="-150" width="150" height="150" fill="rgba(255,255,255,0.02)"/> <rect x="-150" y="0" width="150" height="150" fill="rgba(255,255,255,0.05)"/> <rect x="0" y="0" width="150" height="150" fill="rgba(255,255,255,0.02)"/> <line x1="-150" y1="0" x2="150" y2="0" stroke="white" stroke-width="2"/>
                <line x1="0" y1="-150" x2="0" y2="150" stroke="white" stroke-width="2"/>
                <circle cx="0" cy="0" r="100" stroke="#aaa" fill="none"/>
                
                <text x="50" y="-50" fill="white" font-weight="bold">第1象限</text>
                <text x="-100" y="-50" fill="white" font-weight="bold">第2象限</text>
                <text x="-100" y="50" fill="white" font-weight="bold">第3象限</text>
                <text x="50" y="50" fill="white" font-weight="bold">第4象限</text>
            </svg>
        </div>
        <p>反時計回りに番号がついています。</p>
    </div>

    <div class="slide">
        <h2>三角関数の符号</h2>
        <p>どこでプラスになり、どこでマイナスになるか？</p>
        <div class="row" style="margin-top:20px;">
            <div class="col" style="text-align:center;">
                <h3 class="important" style="border-bottom:3px solid var(--accent-sin);">sin (高さ)</h3>
                <svg viewBox="-100 -100 200 200" width="180" height="180">
                    <circle cx="0" cy="0" r="95" fill="none" stroke="white"/>
                    <path d="M 0 -95 A 95 95 0 0 1 95 0 L 0 0 Z" class="sign-bg-plus"/> <path d="M -95 0 A 95 95 0 0 1 0 -95 L 0 0 Z" class="sign-bg-plus"/> <path d="M -95 0 A 95 95 0 0 0 0 95 L 0 0 Z" class="sign-bg-minus"/> <path d="M 0 95 A 95 95 0 0 0 95 0 L 0 0 Z" class="sign-bg-minus"/> <line x1="-95" y1="0" x2="95" y2="0" stroke="white"/>
                    <line x1="0" y1="-95" x2="0" y2="95" stroke="white"/>
                    <text x="40" y="-40" class="sign-text">+</text>
                    <text x="-40" y="-40" class="sign-text">+</text>
                    <text x="-40" y="50" class="sign-text">-</text>
                    <text x="40" y="50" class="sign-text">-</text>
                </svg>
                <p>上がプラス</p>
            </div>
            <div class="col" style="text-align:center;">
                <h3 class="text-cos" style="border-bottom:3px solid var(--accent-cos);">cos (横)</h3>
                <svg viewBox="-100 -100 200 200" width="180" height="180">
                    <circle cx="0" cy="0" r="95" fill="none" stroke="white"/>
                    <path d="M 0 -95 A 95 95 0 0 1 95 0 L 0 0 Z" class="sign-bg-plus"/>
                    <path d="M -95 0 A 95 95 0 0 1 0 -95 L 0 0 Z" class="sign-bg-minus"/>
                    <path d="M -95 0 A 95 95 0 0 0 0 95 L 0 0 Z" class="sign-bg-minus"/>
                    <path d="M 0 95 A 95 95 0 0 0 95 0 L 0 0 Z" class="sign-bg-plus"/>
                    <line x1="-95" y1="0" x2="95" y2="0" stroke="white"/>
                    <line x1="0" y1="-95" x2="0" y2="95" stroke="white"/>
                    <text x="40" y="-40" class="sign-text">+</text>
                    <text x="-40" y="-40" class="sign-text">-</text>
                    <text x="-40" y="50" class="sign-text">-</text>
                    <text x="40" y="50" class="sign-text">+</text>
                </svg>
                <p>右がプラス</p>
            </div>
            <div class="col" style="text-align:center;">
                <h3 class="text-tan" style="border-bottom:3px solid var(--accent-tan);">tan (傾き)</h3>
                <svg viewBox="-100 -100 200 200" width="180" height="180">
                    <circle cx="0" cy="0" r="95" fill="none" stroke="white"/>
                    <path d="M 0 -95 A 95 95 0 0 1 95 0 L 0 0 Z" class="sign-bg-plus"/>
                    <path d="M -95 0 A 95 95 0 0 1 0 -95 L 0 0 Z" class="sign-bg-minus"/>
                    <path d="M -95 0 A 95 95 0 0 0 0 95 L 0 0 Z" class="sign-bg-plus"/>
                    <path d="M 0 95 A 95 95 0 0 0 95 0 L 0 0 Z" class="sign-bg-minus"/>
                    <line x1="-95" y1="0" x2="95" y2="0" stroke="white"/>
                    <line x1="0" y1="-95" x2="0" y2="95" stroke="white"/>
                    <text x="40" y="-40" class="sign-text">+</text>
                    <text x="-40" y="-40" class="sign-text">-</text>
                    <text x="-40" y="50" class="sign-text">+</text>
                    <text x="40" y="50" class="sign-text">-</text>
                </svg>
                <p>右上がりがプラス</p>
            </div>
        </div>
    </div>

    <div class="slide">
        <h2>【実験】ぐるっと一周</h2>
        <p>座標の符号（＋−）の変化に注目してください。</p>
        <div class="interactive-area">
            <svg id="svg-unit-360" viewBox="-120 -120 240 240" height="350">
                <line x1="-120" y1="0" x2="120" y2="0" stroke="#777"/>
                <line x1="0" y1="-120" x2="0" y2="120" stroke="#777"/>
                <circle cx="0" cy="0" r="100" stroke="white" stroke-width="2" fill="none"/>
                
                <line id="u360-line" x1="0" y1="0" x2="70" y2="-70" stroke="white" stroke-width="2"/>
                <circle id="u360-p" cx="70" cy="-70" r="6" fill="white"/>
                <line id="u360-cos" x1="0" y1="0" x2="70" y2="0" stroke="var(--accent-cos)" stroke-width="4"/>
                <line id="u360-sin" x1="70" y1="0" x2="70" y2="-70" stroke="var(--accent-sin)" stroke-width="4"/>
            </svg>
            <input type="range" id="input-u360" min="0" max="360" value="135" oninput="updateUnit360()">
            <div style="font-size: 1.4rem;">
                $\theta$: <span id="val-u360-deg" class="highlight">135</span>°<br>
                <span class="text-sin">sin: <span id="val-u360-sin">0.71</span></span> / 
                <span class="text-cos">cos: <span id="val-u360-cos">-0.71</span></span> / 
                <span class="text-tan">tan: <span id="val-u360-tan">-1.00</span></span>
            </div>
        </div>
    </div>

    <div class="slide">
        <h2>みんなで解く基本問題 ①</h2>
        <div class="box" style="text-align:left;">
            <p><strong>問題：</strong> ($0^\circ \leqq \theta \leqq 180^\circ$)</p>
            <p style="font-size:2.5rem; text-align:center;">$\sin \theta = \frac{1}{2}$</p>
            <p>を満たす $\theta$ は？</p>
        </div>
        <p class="fragment">ヒント：$\sin$ は「高さ」です。高さが半分の場所を探せ！</p>
    </div>

    <div class="slide">
        <h2>解説：高さが 1/2 の場所</h2>
        <div class="row">
            <div class="col interactive-area" style="background:transparent; border:none; box-shadow:none;">
                <svg viewBox="-110 -110 220 120" style="height:200px;">
                    <path d="M -100 0 A 100 100 0 0 1 100 0" fill="none" stroke="white"/>
                    <line x1="-110" y1="0" x2="110" y2="0" stroke="#777"/>
                    <line x1="-100" y1="-50" x2="100" y2="-50" stroke="var(--accent-sin)" stroke-dasharray="4"/>
                    
                    <line x1="0" y1="0" x2="86.6" y2="-50" stroke="white"/>
                    <circle cx="86.6" cy="-50" r="5" fill="var(--accent-sin)"/>
                    <text x="95" y="-55" fill="white">30°</text>
                    
                    <line x1="0" y1="0" x2="-86.6" y2="-50" stroke="white"/>
                    <circle cx="-86.6" cy="-50" r="5" fill="var(--accent-sin)"/>
                    <text x="-110" y="-55" fill="white">150°</text>
                </svg>
            </div>
            <div class="col box">
                <p>高さがプラスなので上半分。</p>
                <p>30°の定規（1:2:√3）が左右に2つ入ります。</p>
                <p>右：$30^\circ$</p>
                <p>左：$180^\circ - 30^\circ = 150^\circ$</p>
                <p class="highlight">答え：$30^\circ, 150^\circ$</p>
            </div>
        </div>
    </div>

    <div class="slide">
        <h2>みんなで解く基本問題 ②</h2>
        <div class="box" style="text-align:left;">
            <p><strong>問題：</strong> ($0^\circ \leqq \theta \leqq 180^\circ$)</p>
            <p style="font-size:2.5rem; text-align:center;">$\cos \theta = -\frac{1}{2}$</p>
            <p>を満たす $\theta$ は？</p>
        </div>
        <p class="fragment">ヒント：$\cos$ は「横」です。マイナスなので左側！</p>
    </div>

    <div class="slide">
        <h2>解説：横が -1/2 の場所</h2>
        <div class="row">
            <div class="col interactive-area" style="background:transparent; border:none; box-shadow:none;">
                <svg viewBox="-110 -110 220 120" style="height:200px;">
                    <path d="M -100 0 A 100 100 0 0 1 100 0" fill="none" stroke="white"/>
                    <line x1="-110" y1="0" x2="110" y2="0" stroke="#777"/>
                    <line x1="0" y1="-100" x2="0" y2="0" stroke="#777"/>
                    
                    <line x1="-50" y1="0" x2="-50" y2="-100" stroke="var(--accent-cos)" stroke-dasharray="4"/>
                    
                    <line x1="0" y1="0" x2="-50" y2="-86.6" stroke="white"/>
                    <circle cx="-50" cy="-86.6" r="5" fill="var(--accent-cos)"/>
                    
                    <path d="M 0 0 L -50 0 L -50 -86.6 Z" fill="rgba(0, 210, 255, 0.2)"/>
                    <text x="-25" y="-10" fill="white" font-size="12">60°</text>
                </svg>
            </div>
            <div class="col box">
                <p>左に1/2進んだところ。</p>
                <p>ここに60°の定規（縦長）ができます。</p>
                <p>真横（180°）から60°バックする。</p>
                <p>$180^\circ - 60^\circ = 120^\circ$</p>
                <p class="highlight">答え：$120^\circ$</p>
            </div>
        </div>
    </div>

    <div class="slide">
        <h2>【演習】三角比 6本ノック</h2>
        <p>クリックして答えを確認してください。（範囲：$0^\circ \leqq \theta \leqq 360^\circ$）</p>
        <div class="quiz-container">
            <div class="quiz-item" onclick="this.classList.toggle('revealed')">
                <div class="quiz-q">1. $\sin \theta = \frac{\sqrt{3}}{2}$</div>
                <div class="quiz-a">高さが高い(60°系)<br>$60^\circ, 120^\circ$</div>
            </div>
            <div class="quiz-item" onclick="this.classList.toggle('revealed')">
                <div class="quiz-q">2. $\cos \theta = 0$</div>
                <div class="quiz-a">横幅ゼロ（真ん中）<br>$90^\circ, 270^\circ$</div>
            </div>
            <div class="quiz-item" onclick="this.classList.toggle('revealed')">
                <div class="quiz-q">3. $\tan \theta = 1$</div>
                <div class="quiz-a">傾き1（45°系）<br>$45^\circ, 225^\circ$</div>
            </div>
            <div class="quiz-item" onclick="this.classList.toggle('revealed')">
                <div class="quiz-q">4. $\sin \theta = -1$</div>
                <div class="quiz-a">一番下（どん底）<br>$270^\circ$</div>
            </div>
            <div class="quiz-item" onclick="this.classList.toggle('revealed')">
                <div class="quiz-q">5. $\cos \theta = -\frac{1}{\sqrt{2}}$</div>
                <div class="quiz-a">左に45°系<br>$135^\circ, 225^\circ$</div>
            </div>
            <div class="quiz-item" onclick="this.classList.toggle('revealed')">
                <div class="quiz-q">6. $\sin \theta = \cos \theta$</div>
                <div class="quiz-a">縦と横が同じ<br>$45^\circ, 225^\circ$</div>
            </div>
        </div>
    </div>

    <div class="slide">
        <h2>円から「波」へ</h2>
        <p>回転する点の<span class="text-sin">「高さ」</span>だけを時間とともに記録すると、<br>美しい波形が現れます。</p>
    </div>

    <div class="slide">
        <h2>【実験】回転をほどく</h2>
        <p>関数を切り替えてグラフの形を確認しましょう。</p>
        <div class="interactive-area">
            <div style="margin-bottom: 10px;">
                <button class="btn active" onclick="setGraphMode('sin', this)">Sin (高さ)</button>
                <button class="btn" onclick="setGraphMode('cos', this)">Cos (横幅)</button>
                <button class="btn" onclick="setGraphMode('tan', this)">Tan (傾き)</button>
            </div>
            
            <svg id="svg-graph" viewBox="0 0 600 200">
                <line x1="200" y1="20" x2="200" y2="180" stroke="#444" stroke-dasharray="2"/>
                <line x1="295" y1="20" x2="295" y2="180" stroke="#444" stroke-dasharray="2"/>
                <line x1="390" y1="20" x2="390" y2="180" stroke="#444" stroke-dasharray="2"/>
                <line x1="485" y1="20" x2="485" y2="180" stroke="#444" stroke-dasharray="2"/>
                <line x1="580" y1="20" x2="580" y2="180" stroke="#444" stroke-dasharray="2"/>
                <line x1="200" y1="100" x2="600" y2="100" stroke="#666"/> <text x="295" y="195" fill="#888" font-size="12" text-anchor="middle">90°</text>
                <text x="390" y="195" fill="#888" font-size="12" text-anchor="middle">180°</text>
                <text x="485" y="195" fill="#888" font-size="12" text-anchor="middle">270°</text>
                <text x="580" y="195" fill="#888" font-size="12" text-anchor="middle">360°</text>

                <circle cx="100" cy="100" r="60" stroke="#555" fill="none"/>
                <line x1="40" y1="100" x2="160" y2="100" stroke="#333"/>
                <line x1="100" y1="40" x2="100" y2="160" stroke="#333"/>
                
                <line id="graph-radius" x1="100" y1="100" x2="160" y2="100" stroke="white"/>
                <circle id="graph-p" cx="160" cy="100" r="5" fill="var(--accent-sin)"/>
                
                <line id="graph-connector" x1="160" y1="100" x2="200" y2="100" stroke="var(--accent-sin)" stroke-dasharray="4" opacity="0.5"/>
                
                <path id="graph-wave" d="M 200 100" stroke="var(--accent-sin)" fill="none" stroke-width="2"/>
                <circle id="graph-plot" cx="200" cy="100" r="5" fill="var(--accent-sin)"/>
            </svg>
            <input type="range" id="input-graph" min="0" max="360" value="0" oninput="updateGraph()">
            <p>角度: <span id="val-graph-deg">0</span>° / 値: <span id="val-graph-val">0.00</span></p>
        </div>
    </div>

    <div class="slide">
        <h2>ゲーム応用：キャラクターの軌道</h2>
        <p>ゲームのキャラが回転したり、敵を追尾するとき、<br>$\cos$ (X座標) と $\sin$ (Y座標) が使われています。</p>
        <div class="interactive-area">
            <svg id="svg-game" viewBox="0 0 300 200">
                <circle cx="150" cy="100" r="5" fill="#555"/>
                <text x="150" y="120" fill="#888" text-anchor="middle" font-size="12">Center (0,0)</text>
                
                <circle cx="150" cy="100" r="80" stroke="#333" fill="none" stroke-dasharray="4"/>
                
                <g id="game-char">
                    <circle cx="0" cy="0" r="10" fill="var(--accent-history)"/>
                    <text x="0" y="-15" fill="white" text-anchor="middle" font-size="12">Player</text>
                </g>
                
                <text x="10" y="20" fill="var(--accent-cos)" font-size="14">x = r × cos(θ)</text>
                <text x="10" y="40" fill="var(--accent-sin)" font-size="14">y = r × sin(θ)</text>
            </svg>
            <input type="range" id="input-game" min="0" max="360" value="0" oninput="updateGameChar()">
        </div>
    </div>

    <div class="slide">
        <h2>アート応用：リサージュ図形</h2>
        <p>縦と横の速度（周波数）を変えると、美しい模様が生まれます。<br>$x = \sin(at), \quad y = \sin(bt)$</p>
        <div class="interactive-area" style="background:#000;">
            <canvas id="canvas-lissajous" width="300" height="300"></canvas>
            <div style="width:80%; margin-top:10px;">
                <label>横の速度 (a): <input type="range" id="lis-a" min="1" max="10" step="1" value="3" style="width:100px; transform:scale(1);"></label>
                <label>縦の速度 (b): <input type="range" id="lis-b" min="1" max="10" step="1" value="5" style="width:100px; transform:scale(1);"></label>
            </div>
            <p>複雑な花のようなパターンが描かれます。</p>
        </div>
    </div>

    <div class="slide">
        <h2>歴史トリビア：砂漠の天文学者たち</h2>
        <p>三角比を「測量」から「関数」へ進化させたのは、<br>中世イスラム（9〜11世紀頃）の学者たちでした。</p>
        <div class="box fragment">
            <p>彼らには切実な動機がありました。<br><strong>「メッカの方角を正確に知りたい」</strong></p>
        </div>
    </div>

    <div class="slide">
        <h2>偉人：アル・ビールーニー (973-1048)</h2>
        <p>11世紀の天才ビールーニーは、三角法を駆使して<br><span class="highlight">地球の大きさ（半径）</span>をたった一人で計算しました。</p>
        <div class="box fragment">
            <p>算出値：<strong>半径 約6339.6 km</strong></p>
            <p>現代の値(約6371km)との<span class="important">誤差はわずか0.5%！</span></p>
        </div>
    </div>

    <div class="slide">
        <h2>ビールーニーの方法（ナンダナ山にて）</h2>
        <div class="row">
            <div class="col fragment">
                <svg viewBox="0 0 300 200">
                    <path d="M 0 200 Q 150 150 300 200" stroke="#555" fill="none"/>
                    <path d="M 50 200 L 100 100 L 150 200" fill="#333" stroke="white"/>
                    <text x="110" y="140" fill="white" font-size="12">高さ h</text>
                    <line x1="100" y1="100" x2="280" y2="190" stroke="var(--accent-tan)" stroke-dasharray="4"/>
                    <text x="180" y="130" fill="var(--accent-tan)" font-size="12">視線 (俯角α)</text>
                    <line x1="150" y1="400" x2="100" y2="100" stroke="#555"/>
                </svg>
            </div>
            <div class="col" style="font-size:1.4rem;">
                <ol>
                    <li>高い山に登り、高さ $h$ を測る。</li>
                    <li>地平線を見下ろす角度（俯角 $\alpha$）をアストロラーベで超精密に測定。</li>
                    <li>直角三角形の計算：<br>$R = h \frac{\cos \alpha}{1 - \cos \alpha}$</li>
                </ol>
                <p>砂漠を歩き回ることなく、数学の力だけで地球を測ったのです。</p>
            </div>
        </div>
    </div>

    <div class="slide">
        <h1>まとめ</h1>
        <ul>
            <li class="fragment">三角比は、直角三角形の<span class="highlight">「辺の比率」</span>。</li>
            <li class="fragment">単位円（半径1）を使えば、<span class="important">座標</span>として扱える。</li>
            <li class="fragment">sin, cos, tan は現代科学の「言語」です。</li>
        </ul>
        <p class="fragment" style="margin-top: 30px;">数学は、世界を記述する言葉です。</p>
    </div>

    <div class="slide">
        <h2>お疲れ様でした！</h2>
        <p>これで三角比の基礎は完了です。</p>
        <button class="btn" onclick="goToSlide(0)" style="margin-top: 40px;">最初に戻る</button>
    </div>

</div>

<div id="controls">
    <button class="btn" onclick="prevStep()">◀</button>
    <button class="btn" onclick="nextStep()">▶</button>
</div>
<div id="progress-bar"></div>

<script>
    /* --- Slide Presentation Logic --- */
    const slides = document.querySelectorAll('.slide');
    const progressBar = document.getElementById('progress-bar');
    let currentSlide = 0;

    slides.forEach(slide => {
        slide.dataset.currentFragment = -1;
        slide.dataset.totalFragments = slide.querySelectorAll('.fragment').length;
    });

    function updateView() {
        slides.forEach((slide, index) => {
            slide.classList.remove('active', 'past');
            if (index === currentSlide) {
                slide.classList.add('active');
            } else if (index < currentSlide) {
                slide.classList.add('past');
            }
        });
        const progress = ((currentSlide + 1) / slides.length) * 100;
        progressBar.style.width = `${progress}%`;
        
        // Start animation loop if Lissajous slide is active
        if(slides[currentSlide].innerHTML.includes('canvas-lissajous')) {
            requestAnimationFrame(drawLissajous);
        }
    }

    function nextStep() {
        const slide = slides[currentSlide];
        const totalFragments = parseInt(slide.dataset.totalFragments);
        let currentFragment = parseInt(slide.dataset.currentFragment);

        if (currentFragment < totalFragments - 1) {
            currentFragment++;
            const fragments = slide.querySelectorAll('.fragment');
            fragments[currentFragment].classList.add('visible');
            slide.dataset.currentFragment = currentFragment;
        } else {
            if (currentSlide < slides.length - 1) {
                currentSlide++;
                updateView();
            }
        }
    }

    function prevStep() {
        const slide = slides[currentSlide];
        let currentFragment = parseInt(slide.dataset.currentFragment);

        if (currentFragment >= 0) {
            const fragments = slide.querySelectorAll('.fragment');
            fragments[currentFragment].classList.remove('visible');
            slide.dataset.currentFragment = currentFragment - 1;
        } else {
            if (currentSlide > 0) {
                currentSlide--;
                updateView();
            }
        }
    }

    function goToSlide(index) {
        slides.forEach(slide => {
            slide.dataset.currentFragment = -1;
            slide.querySelectorAll('.fragment').forEach(f => f.classList.remove('visible'));
        });
        currentSlide = index;
        updateView();
    }

    document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight' || e.key === ' ' || e.key === 'Enter') nextStep();
        if (e.key === 'ArrowLeft') prevStep();
    });

    /* --- Interactive Visualizations --- */

    // 1. Thales Pyramid (Corrected Geometry)
    function updateThales() {
        const angleDeg = document.getElementById('thales-slider').value;
        const rad = angleDeg * (Math.PI / 180);
        
        // Stick height = 50. Base Y = 250. Stick Top Y = 200. X = 100.
        // Stick Shadow Length L = 50 / tan(theta).
        const stickShadowL = 50 / Math.tan(rad);
        
        // Ray Logic for Stick:
        // Ray should start "in the sky" and pass through (100, 200) to (100+L, 250).
        // Let's extend it backwards to Y=150.
        // Slope m = 50/L = tan(theta).
        // Delta X for Delta Y=50 is L.
        // Start X = 100 - L. Start Y = 150.
        const rayStickStartX = 100 - stickShadowL;
        const rayStickEndX = 100 + stickShadowL;
        
        document.getElementById('shadow-stick').setAttribute('x2', rayStickEndX);
        document.getElementById('ray-stick').setAttribute('x1', rayStickStartX);
        document.getElementById('ray-stick').setAttribute('y1', 150); // Sky
        document.getElementById('ray-stick').setAttribute('x2', rayStickEndX);
        document.getElementById('ray-stick').setAttribute('y2', 250); // Ground

        // Pyramid Height = 150. Base Y = 250. Top Y = 100. Center X = 450.
        // Shadow L = 150 / tan(theta).
        const pyrShadowL = 150 / Math.tan(rad);
        
        // Ray Logic for Pyramid:
        // Pass through (450, 100).
        // Extend backwards to Y = -50 (Sky high).
        // Delta Y = 150. Delta X = pyrShadowL.
        // From Top(450,100) to Y=-50 is Delta Y = -150.
        // X shift = pyrShadowL.
        const rayPyrStartX = 450 - pyrShadowL;
        const rayPyrEndX = 450 + pyrShadowL;
        
        document.getElementById('shadow-pyramid').setAttribute('x2', rayPyrEndX);
        document.getElementById('ray-pyramid').setAttribute('x1', rayPyrStartX);
        document.getElementById('ray-pyramid').setAttribute('y1', -50);
        document.getElementById('ray-pyramid').setAttribute('x2', rayPyrEndX);
        document.getElementById('ray-pyramid').setAttribute('y2', 250);

        // Update Text
        const realShadowStick = stickShadowL * 0.02; 
        const realShadowPyr = pyrShadowL * 0.02;
        const text = `角度${angleDeg}° : 杖影 ${realShadowStick.toFixed(2)}m (1:${realShadowStick.toFixed(2)}) / ピラミッド影 ${realShadowPyr.toFixed(1)}m`;
        document.getElementById('thales-text').textContent = text;
    }
    updateThales();

    // 2. Unit Circle 0-90
    function updateUnit90() {
        const deg = document.getElementById('input-u90').value;
        const rad = deg * (Math.PI / 180);
        const r = 200; 
        
        const cos = Math.cos(rad);
        const sin = Math.sin(rad);
        
        const px = cos * r;
        const py = 200 - (sin * r);
        
        document.getElementById('u90-hyp').setAttribute('x2', px);
        document.getElementById('u90-hyp').setAttribute('y2', py);
        document.getElementById('u90-cos').setAttribute('x2', px);
        document.getElementById('u90-sin').setAttribute('x1', px);
        document.getElementById('u90-sin').setAttribute('x2', px);
        document.getElementById('u90-sin').setAttribute('y2', py);
        document.getElementById('u90-p').setAttribute('cx', px);
        document.getElementById('u90-p').setAttribute('cy', py);

        const tanX = 200;
        const tanY = 200 - (Math.tan(rad) * 200);
        document.getElementById('u90-tan-line').setAttribute('x2', tanX);
        document.getElementById('u90-tan-line').setAttribute('y2', tanY);
        
        document.getElementById('val-u90-deg').textContent = deg;
        document.getElementById('val-u90-sin').textContent = Math.abs(sin).toFixed(2);
        document.getElementById('val-u90-cos').textContent = Math.abs(cos).toFixed(2);
        document.getElementById('val-u90-tan').textContent = Math.tan(rad).toFixed(2);
    }
    updateUnit90();

    // 3. Unit Circle 0-360
    function updateUnit360() {
        const deg = document.getElementById('input-u360').value;
        const rad = deg * (Math.PI / 180);
        const r = 100;
        
        const cos = Math.cos(rad);
        const sin = Math.sin(rad); 
        
        const px = cos * r;
        const py = -sin * r;
        
        document.getElementById('u360-line').setAttribute('x2', px);
        document.getElementById('u360-line').setAttribute('y2', py);
        document.getElementById('u360-p').setAttribute('cx', px);
        document.getElementById('u360-p').setAttribute('cy', py);
        document.getElementById('u360-cos').setAttribute('x2', px);
        document.getElementById('u360-sin').setAttribute('x1', px);
        document.getElementById('u360-sin').setAttribute('x2', px);
        document.getElementById('u360-sin').setAttribute('y2', py);
        
        document.getElementById('val-u360-deg').textContent = deg;
        document.getElementById('val-u360-sin').textContent = sin.toFixed(2);
        document.getElementById('val-u360-cos').textContent = cos.toFixed(2);
        
        let tanVal = "∞";
        if (Math.abs(Math.cos(rad)) > 0.0001) {
            tanVal = Math.tan(rad).toFixed(2);
        }
        document.getElementById('val-u360-tan').textContent = tanVal;
    }
    updateUnit360();

    // 4. Graph Animation (Enhanced)
    let graphMode = 'sin';
    function setGraphMode(mode, btn) {
        graphMode = mode;
        // update buttons
        const btns = document.querySelectorAll('#svg-graph + .interactive-area button, .interactive-area button');
        btns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        // Update styling of moving parts
        const color = mode === 'sin' ? 'var(--accent-sin)' : 
                      mode === 'cos' ? 'var(--accent-cos)' : 'var(--accent-tan)';
        
        document.getElementById('graph-p').setAttribute('fill', color);
        document.getElementById('graph-plot').setAttribute('fill', color);
        document.getElementById('graph-wave').setAttribute('stroke', color);
        document.getElementById('graph-connector').setAttribute('stroke', color);
        
        updateGraph();
    }

    function updateGraph() {
        const deg = parseInt(document.getElementById('input-graph').value);
        const rad = deg * (Math.PI / 180);
        const r = 60;
        const cx = 100;
        const cy = 100;
        
        // Circle point P
        const px = cx + Math.cos(rad) * r;
        const py = cy - Math.sin(rad) * r;
        
        document.getElementById('graph-radius').setAttribute('x2', px);
        document.getElementById('graph-radius').setAttribute('y2', py);
        document.getElementById('graph-p').setAttribute('cx', px);
        document.getElementById('graph-p').setAttribute('cy', py);
        
        // Calculate Value based on mode
        let val = 0;
        if(graphMode === 'sin') val = Math.sin(rad);
        if(graphMode === 'cos') val = Math.cos(rad);
        if(graphMode === 'tan') val = Math.tan(rad);
        
        // Limit tan for visual sanity
        if(graphMode === 'tan') val = Math.max(-5, Math.min(5, val));

        // Graph Plot Point (x maps 0-360 to 200-580)
        const graphX = 200 + (deg / 360) * 380;
        
        // Graph Y: center 100. Scale same as radius (60) for sin/cos.
        // For tan, maybe scale down a bit or keep same.
        const graphY = 100 - val * 60;
        
        document.getElementById('graph-plot').setAttribute('cx', graphX);
        document.getElementById('graph-plot').setAttribute('cy', graphY);
        
        // Connector Line
        // Sin: Horizontal from Circle P to Graph P
        // Cos: From P vertically down to axis? No, strictly mapping value.
        // Let's just connect current P's relevant coord to Graph Y.
        // Actually, the visual metaphor works best for Sin (Height->Height).
        // For Cos (Width), visual link is harder. Just show line to Y.
        document.getElementById('graph-connector').setAttribute('x1', px);
        document.getElementById('graph-connector').setAttribute('y1', py);
        document.getElementById('graph-connector').setAttribute('x2', graphX);
        document.getElementById('graph-connector').setAttribute('y2', graphY);
        
        // Draw Path
        let d = "";
        let move = true;
        for (let i = 0; i <= deg; i+=2) {
            const r_i = i * (Math.PI / 180);
            const x_i = 200 + (i / 360) * 380;
            let v_i = 0;
            if(graphMode === 'sin') v_i = Math.sin(r_i);
            if(graphMode === 'cos') v_i = Math.cos(r_i);
            if(graphMode === 'tan') v_i = Math.tan(r_i);
            
            // Tan discontinuity check
            if (graphMode === 'tan') {
                if (Math.abs(v_i) > 5) {
                    move = true; // Lift pen
                    continue;
                }
            }
            
            const y_i = 100 - v_i * 60;
            
            if (move) {
                d += `M ${x_i} ${y_i}`;
                move = false;
            } else {
                d += ` L ${x_i} ${y_i}`;
            }
        }
        document.getElementById('graph-wave').setAttribute('d', d);

        document.getElementById('val-graph-deg').textContent = deg;
        document.getElementById('val-graph-val').textContent = val.toFixed(2);
    }
    updateGraph(); // Init

    // 5. Game Character
    function updateGameChar() {
        const deg = document.getElementById('input-game').value;
        const rad = deg * (Math.PI / 180);
        const r = 80;
        
        const x = r * Math.cos(rad);
        const y = r * Math.sin(rad); // SVG coordinate: y down is positive
        
        // We want y up to be positive math convention in visualization?
        // Game screens usually have y down. 
        // Let's stick to screen coords: cx=150, cy=100.
        // But sin(0)=0, sin(90)=1. 
        // In screen: 0deg (right) -> x=r, y=0.
        // 90deg (down in svg rotation, or up?). Math 90 is up.
        // Let's map Math (Counter-Clockwise) to Screen.
        // Math x = cos, Math y = sin.
        // Screen x = cx + x. Screen y = cy - y.
        
        const sx = 150 + x;
        const sy = 100 - y;
        
        const char = document.getElementById('game-char');
        char.setAttribute('transform', `translate(${sx}, ${sy})`);
    }

    // 6. Lissajous
    let lisTime = 0;
    function drawLissajous() {
        const canvas = document.getElementById('canvas-lissajous');
        if(!canvas) return; // Not on slide
        const ctx = canvas.getContext('2d');
        const a = parseInt(document.getElementById('lis-a').value);
        const b = parseInt(document.getElementById('lis-b').value);
        
        // Fade effect
        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        
        ctx.fillStyle = '#00ff9d';
        
        // Draw multiple dots to speed up
        for(let i=0; i<10; i++) {
            lisTime += 0.01;
            const x = 150 + 120 * Math.sin(a * lisTime + Math.PI/2); // sin(at)
            const y = 150 + 120 * Math.sin(b * lisTime);     // sin(bt)
            
            ctx.beginPath();
            ctx.arc(x, y, 2, 0, Math.PI*2);
            ctx.fill();
        }
        
        if(canvas.offsetParent !== null) {
            requestAnimationFrame(drawLissajous);
        }
    }
    
</script>
</body>
</html>